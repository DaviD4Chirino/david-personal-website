---
export const prerender = true;

import type { GetStaticPaths } from "astro";
import { getCollection, type CollectionEntry } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Blog from "../../components/pages/Blog";

interface Props {
  page: PaginatedCollection<"posts">;
  allPosts: CollectionEntry<"posts">[];
}

export const getStaticPaths = (async ({ paginate }) => {
  const posts: CollectionEntry<"posts">[] = await getCollection("posts");
  let paginated = paginate(posts, { pageSize: 10 });

  paginated = paginated.map((pag) => {
    return {
      params: { ...pag.params },
      props: { ...pag.props, allPosts: posts },
    };
  });

  return paginated;
}) satisfies GetStaticPaths;

const { page, allPosts } = Astro.props;
---

<Layout title="Blogs - David'Space">
  <Blog page={page} totalPosts={allPosts} client:load />
</Layout>
